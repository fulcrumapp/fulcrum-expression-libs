!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.mgrs=e()}}(function(){return function e(t,r,n){function a(i,s){if(!r[i]){if(!t[i]){var f="function"==typeof require&&require;if(!s&&f)return f(i,!0);if(o)return o(i,!0);var h=new Error("Cannot find module '"+i+"'");throw h.code="MODULE_NOT_FOUND",h}var c=r[i]={exports:{}};t[i][0].call(c.exports,function(e){var r=t[i][1][e];return a(r?r:e)},c,c.exports,e,t,r,n)}return r[i].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)a(n[i]);return a}({mgrs:[function(e,t,r){function n(e){return e*(Math.PI/180)}function a(e){return 180*(e/Math.PI)}function o(e){var t,r,a,o,i,f,h,c,u,l=e.lat,M=e.lon,d=6378137,b=.00669438,v=.9996,g=n(l),m=n(M);u=Math.floor((M+180)/6)+1,180===M&&(u=60),l>=56&&l<64&&M>=3&&M<12&&(u=32),l>=72&&l<84&&(M>=0&&M<9?u=31:M>=9&&M<21?u=33:M>=21&&M<33?u=35:M>=33&&M<42&&(u=37)),t=6*(u-1)-180+3,c=n(t),r=b/(1-b),a=d/Math.sqrt(1-b*Math.sin(g)*Math.sin(g)),o=Math.tan(g)*Math.tan(g),i=r*Math.cos(g)*Math.cos(g),f=Math.cos(g)*(m-c),h=d*((1-b/4-3*b*b/64-5*b*b*b/256)*g-(3*b/8+3*b*b/32+45*b*b*b/1024)*Math.sin(2*g)+(15*b*b/256+45*b*b*b/1024)*Math.sin(4*g)-35*b*b*b/3072*Math.sin(6*g));var p=v*a*(f+(1-o+i)*f*f*f/6+(5-18*o+o*o+72*i-58*r)*f*f*f*f*f/120)+5e5,k=v*(h+a*Math.tan(g)*(f*f/2+(5-o+9*i+4*i*i)*f*f*f*f/24+(61-58*o+o*o+600*i-330*r)*f*f*f*f*f*f/720));return l<0&&(k+=1e7),{northing:Math.round(k),easting:Math.round(p),zoneNumber:u,zoneLetter:s(l)}}function i(e){var t=e.northing,r=e.easting,n=e.zoneLetter,o=e.zoneNumber;if(o<0||o>60)return null;var s,f,h,c,u,l,M,d,b,v,g=.9996,m=6378137,p=.00669438,k=(1-Math.sqrt(1-p))/(1+Math.sqrt(1-p)),w=r-5e5,A=t;n<"N"&&(A-=1e7),d=6*(o-1)-180+3,s=p/(1-p),M=A/g,b=M/(m*(1-p/4-3*p*p/64-5*p*p*p/256)),v=b+(3*k/2-27*k*k*k/32)*Math.sin(2*b)+(21*k*k/16-55*k*k*k*k/32)*Math.sin(4*b)+151*k*k*k/96*Math.sin(6*b),f=m/Math.sqrt(1-p*Math.sin(v)*Math.sin(v)),h=Math.tan(v)*Math.tan(v),c=s*Math.cos(v)*Math.cos(v),u=m*(1-p)/Math.pow(1-p*Math.sin(v)*Math.sin(v),1.5),l=w/(f*g);var z=v-f*Math.tan(v)/u*(l*l/2-(5+3*h+10*c-4*c*c-9*s)*l*l*l*l/24+(61+90*h+298*c+45*h*h-252*s-3*c*c)*l*l*l*l*l*l/720);z=a(z);var C=(l-(1+2*h+c)*l*l*l/6+(5-2*c+28*h-3*c*c+8*s+24*h*h)*l*l*l*l*l/120)/Math.cos(v);C=d+a(C);var N;if(e.accuracy){var y=i({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});N={top:y.lat,right:y.lon,bottom:z,left:C}}else N={lat:z,lon:C};return N}function s(e){var t="Z";return 84>=e&&e>=72?t="X":72>e&&e>=64?t="W":64>e&&e>=56?t="V":56>e&&e>=48?t="U":48>e&&e>=40?t="T":40>e&&e>=32?t="S":32>e&&e>=24?t="R":24>e&&e>=16?t="Q":16>e&&e>=8?t="P":8>e&&e>=0?t="N":0>e&&e>=-8?t="M":-8>e&&e>=-16?t="L":-16>e&&e>=-24?t="K":-24>e&&e>=-32?t="J":-32>e&&e>=-40?t="H":-40>e&&e>=-48?t="G":-48>e&&e>=-56?t="F":-56>e&&e>=-64?t="E":-64>e&&e>=-72?t="D":-72>e&&e>=-80&&(t="C"),t}function f(e,t){var r="00000"+e.easting,n="00000"+e.northing;return e.zoneNumber+e.zoneLetter+h(e.easting,e.northing,e.zoneNumber)+r.substr(r.length-5,t)+n.substr(n.length-5,t)}function h(e,t,r){var n=c(r),a=Math.floor(e/1e5),o=Math.floor(t/1e5)%20;return u(a,o,n)}function c(e){var t=e%v;return 0===t&&(t=v),t}function u(e,t,r){var n=r-1,a=g.charCodeAt(n),o=m.charCodeAt(n),i=a+e-1,s=o+t,f=!1;i>z&&(i=i-z+p-1,f=!0),(i===k||a<k&&i>k||(i>k||a<k)&&f)&&i++,(i===w||a<w&&i>w||(i>w||a<w)&&f)&&(i++,i===k&&i++),i>z&&(i=i-z+p-1),s>A?(s=s-A+p-1,f=!0):f=!1,(s===k||o<k&&s>k||(s>k||o<k)&&f)&&s++,(s===w||o<w&&s>w||(s>w||o<w)&&f)&&(s++,s===k&&s++),s>A&&(s=s-A+p-1);var h=String.fromCharCode(i)+String.fromCharCode(s);return h}function l(e){if(e&&0===e.length)throw"MGRSPoint coverting from nothing";for(var t,r=e.length,n=null,a="",o=0;!/[A-Z]/.test(t=e.charAt(o));){if(o>=2)throw"MGRSPoint bad conversion from: "+e;a+=t,o++}var i=parseInt(a,10);if(0===o||o+3>r)throw"MGRSPoint bad conversion from: "+e;var s=e.charAt(o++);if(s<="A"||"B"===s||"Y"===s||s>="Z"||"I"===s||"O"===s)throw"MGRSPoint zone letter "+s+" not handled: "+e;n=e.substring(o,o+=2);for(var f=c(i),h=M(n.charAt(0),f),u=d(n.charAt(1),f);u<b(s);)u+=2e6;var l=r-o;if(l%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+e;var v,g,m,p,k,w=l/2,A=0,z=0;return w>0&&(v=1e5/Math.pow(10,w),g=e.substring(o,o+w),A=parseFloat(g)*v,m=e.substring(o+w),z=parseFloat(m)*v),p=A+h,k=z+u,{easting:p,northing:k,zoneLetter:s,zoneNumber:i,accuracy:v}}function M(e,t){for(var r=g.charCodeAt(t-1),n=1e5,a=!1;r!==e.charCodeAt(0);){if(r++,r===k&&r++,r===w&&r++,r>z){if(a)throw"Bad character: "+e;r=p,a=!0}n+=1e5}return n}function d(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var r=m.charCodeAt(t-1),n=0,a=!1;r!==e.charCodeAt(0);){if(r++,r===k&&r++,r===w&&r++,r>A){if(a)throw"Bad character: "+e;r=p,a=!0}n+=1e5}return n}function b(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+e}var v=6,g="AJSAJS",m="AFAFAF",p=65,k=73,w=79,A=86,z=90;r.forward=function(e,t){return t=t||5,f(o({lat:e[1],lon:e[0]}),t)},r.inverse=function(e){var t=i(l(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]},r.toPoint=function(e){var t=i(l(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}},{}]},{},[])("mgrs")});

var mgrs = module.exports;
